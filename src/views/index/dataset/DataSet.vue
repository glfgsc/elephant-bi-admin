<template>
    <div style="height:90vh">
        <v-tabs
        v-model="tab"
        density="compact"
        slider-color="primary"
        style="height:5vh"
        >
            <v-tab :value="'workspace'">
                <span class="text-caption">我的数据集</span>
            </v-tab>
            <v-tab :value="'shareData'">
                <span class="text-caption">分享数据集</span>
            </v-tab>
        </v-tabs>
        <v-window v-model="tab">
            <v-window-item value="workspace">
                <div class="d-flex flex-row justify-space-between align-center ml-2 mr-2 mt-2">
                    <div class="d-flex flex-row justify-start align-center">
                        <el-input size="small" clearable v-model="queryPacksTablesParams.name"   placeholder="搜索工作簿和表"  class="mr-2">
                            <template #prefix>
                                <v-icon icon="mdi:mdi-magnify"></v-icon>
                            </template>
                        </el-input>
                    </div>
                    <div class="d-flex flex-row justify-start aligin center">
                        <el-dropdown>
                            <el-button text size="small">
                                <el-icon size="small" color="#409EFF" >
                                    <svg t="1713510686186" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5252" width="200" height="200"><path d="M378.88 829.44v-131.413333h51.2c3.413333-20.48 6.826667-39.253333 11.946667-58.026667h-63.146667v-131.413333h134.826667c18.773333-22.186667 39.253333-40.96 61.44-58.026667H378.88v-131.413333h250.88v97.28c13.653333-6.826667 29.013333-13.653333 44.373333-18.773334v-78.506666h220.16v66.56c15.36 3.413333 29.013333 8.533333 44.373334 13.653333V153.6c0-29.013333-22.186667-51.2-51.2-51.2H136.533333C107.52 102.4 85.333333 124.586667 85.333333 153.6v682.666667c0 29.013333 22.186667 51.2 51.2 51.2h315.733334c-6.826667-18.773333-13.653333-37.546667-17.066667-58.026667h-56.32z m-42.666667 0H129.706667v-131.413333h206.506666v131.413333z m0-189.44H129.706667v-131.413333h206.506666v131.413333z m0-189.44H129.706667v-131.413333h206.506666v131.413333zM768 477.866667c-141.653333 0-256 114.346667-256 256s114.346667 256 256 256 256-114.346667 256-256-114.346667-256-256-256z m34.133333 290.133333v153.6h-68.266666v-153.6h-153.6v-68.266667h153.6v-153.6h68.266666v153.6h153.6v68.266667h-153.6z"  p-id="5253"></path></svg>
                                </el-icon>
                                <span class="text-caption">新建表</span>
                            </el-button>
                            <template #dropdown>
                                <el-dropdown-menu>
                                    <el-dropdown-item>
                                        <el-icon size="small">
                                            <svg t="1713510829083" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6243" width="200" height="200"><path d="M896 543.232h-69.76V408.512c-4.736 2.368-7.04 2.368-11.712 2.368H628.352c-44.16 0-81.472-37.248-81.472-81.472V143.232c0-4.672 0-7.04 2.368-11.648h-339.84c-6.912 0-11.584 4.672-11.584 11.648v400H128v-400c0-44.16 37.248-81.472 81.472-79.104h400.256c23.296 0 41.92 6.976 58.24 23.232l204.8 204.8c13.952 13.952 23.232 34.944 23.232 55.872v195.2z m-81.472-202.24c4.672 0 7.04 2.368 9.344 0l-207.168-204.8c0-2.24-2.304-2.24-2.304-2.24 2.304 2.304 2.304 6.976 2.304 9.28v186.24c0 6.912 4.672 11.52 11.648 11.52h186.24zM134.912 941.824c-4.352 0-6.592-2.304-6.592-6.912v-52.672c0-4.608 2.24-6.912 6.592-6.912H300.8v-55.936H134.592c-4.416 0-6.592-2.304-6.592-6.912V635.584c0-4.608 2.176-6.912 6.592-6.912H367.36c4.352 0 6.592 2.304 6.592 6.912v52.608c0 4.608-2.24 6.912-6.592 6.912H201.536v55.936h166.528c4.352 0 6.592 2.304 6.592 6.912v176.896c0 4.608-2.24 6.912-6.592 6.912H134.912z m287.552-307.648c0-4.608 2.176-6.912 6.592-6.912h264.96c4.48 0 6.656 2.304 6.656 6.912v276.032c0 4.608-2.24 6.912-6.592 6.912H625.728l4.48 22.528 0.384 2.176c0 3.648-2.176 5.44-6.592 5.44h-52.736c-4.16 0-6.464-2.048-6.912-6.144l-4.48-24H428.992c-4.416 0-6.592-2.304-6.592-6.912V634.112z m191.104 218.624h13.184V691.84H496.704v160.896h52.352l-4.16-25.408V825.6c0-3.84 1.984-5.824 5.888-5.824h51.008c3.968 0 6.272 2.048 6.976 6.144l4.8 26.88z m213.76 23.296h120c4.416 0 6.592 2.304 6.592 6.848v51.584c0 4.608-2.176 6.912-6.592 6.912H759.68c-4.416 0-6.592-2.304-6.592-6.912V635.2c0-4.608 2.176-6.912 6.592-6.912h61.056c4.352 0 6.592 2.304 6.592 6.912v240.832z" fill="#F57A51" p-id="6244"></path></svg>
                                        </el-icon>
                                        <span class="text-caption">SQL数据集</span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <el-icon size="small">
                                            <svg t="1713510918934" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7249" width="200" height="200"><path d="M893.866667 1024H162.645333a36.693333 36.693333 0 0 1-36.608-36.693333V36.608A36.693333 36.693333 0 0 1 162.645333 0h485.205334a37.546667 37.546667 0 0 1 26.026666 10.581333l246.101334 246.016a36.693333 36.693333 0 0 1 10.581333 26.026667v704.682667a36.778667 36.778667 0 0 1-36.693333 36.693333zM524.288 635.904a2.389333 2.389333 0 0 1 1.877333 1.024c13.738667 20.224 25.173333 37.034667 36.949334 54.784l56.490666 80.298667a11.264 11.264 0 0 0 9.216 4.778666h51.2a11.264 11.264 0 0 0 10.154667-6.229333 11.008 11.008 0 0 0-1.024-11.776L577.450667 609.28a11.178667 11.178667 0 0 1 0-13.397333l103.765333-143.530667a11.093333 11.093333 0 0 0 0.853333-11.776 11.093333 11.093333 0 0 0-10.069333-6.229333h-47.018667a11.264 11.264 0 0 0-9.472 5.034666l-49.749333 75.349334a555.349333 555.349333 0 0 0-30.805333 51.2 2.218667 2.218667 0 0 1-1.877334 1.109333 2.218667 2.218667 0 0 1-1.877333-1.024l-12.970667-19.370667c-7.850667-11.690667-14.421333-21.504-21.589333-31.658666l-51.2-75.434667a11.264 11.264 0 0 0-9.386667-5.034667h-51.2a11.264 11.264 0 0 0-10.154666 6.229334 11.008 11.008 0 0 0 0.938666 11.776L479.573333 593.664a11.178667 11.178667 0 0 1 0 13.397333L367.701333 758.869333a11.008 11.008 0 0 0-1.024 11.776 11.093333 11.093333 0 0 0 10.069334 6.229334h47.530666a11.264 11.264 0 0 0 9.301334-4.949334l54.698666-80.128c3.498667-5.546667 7.082667-11.093333 10.666667-17.066666l0.682667-1.109334 0.512-0.768c7.338667-11.349333 14.848-23.04 22.613333-36.181333a2.474667 2.474667 0 0 1 1.365333-0.682667zM631.381333 83.882667v215.125333H846.506667z" fill="#34C724" p-id="7250"></path></svg>
                                        </el-icon>
                                        <span class="text-caption">EXCEL数据集</span>
                                    </el-dropdown-item>
                                </el-dropdown-menu>
                            </template>
                        </el-dropdown>
                        <el-button text size="small" @click="addWorkbook">
                            <el-icon size="small" color="#409EFF" >
                                <svg t="1713496862257" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5272" width="200" height="200"><path d="M736 704V576a32 32 0 1 1 64 0v128h128a32 32 0 1 1 0 64h-128v128a32 32 0 1 1-64 0v-128h-128a32 32 0 1 1 0-64h128zM576 838.4v76.8H198.4A134.4 134.4 0 0 1 64 780.8V64h382.976l118.336 134.4H825.6c74.24 0 134.4 60.16 134.4 134.4V512h-76.8v-51.2H140.8v320a57.6 57.6 0 0 0 57.6 57.6H576zM883.2 384v-51.2a57.6 57.6 0 0 0-57.6-57.6H530.56L412.288 140.8H140.8V384h742.4z"  p-id="5273"></path></svg>
                            </el-icon>
                            <span class="text-caption">新建工作簿</span>
                        </el-button> 
                        <el-button text size=small>
                            <el-icon size="small" color="#409EFF">
                                <svg t="1713512130360" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4325" width="200" height="200"><path d="M532.352 96c-138.688 0-260.992 88-312.32 218.304C111.808 337.344 32 437.248 32 554.688c0 135.168 105.152 245.312 235.648 245.312a32 32 0 1 0 0-64C173.184 736 96 655.168 96 554.688c0-92.608 65.92-169.664 151.68-180.16a32 32 0 0 0 26.496-21.632C312.32 238.08 415.424 160 532.352 160c145.6 0 265.92 120.32 273.152 273.472a32 32 0 0 0 23.68 29.44c57.472 15.296 98.816 70.336 98.816 134.4 0 76.928-58.944 138.688-130.88 138.688a32 32 0 1 0 0 64c107.968 0 194.88-91.072 194.88-202.688 0-84.672-50.432-159.104-124.288-188.928C848.768 232.32 705.6 96 532.352 96z m11.648 557.248V928a32 32 0 1 1-64 0v-274.752l-73.344 73.408a32 32 0 0 1-45.312-45.312l128-128a32 32 0 0 1 45.312 0l128 128a32 32 0 0 1-45.312 45.312L544 653.248z"  p-id="4326"></path></svg>
                            </el-icon>
                            <span class="text-caption">上传文件</span>
                        </el-button>
                        <el-button text size=small>
                            <el-icon size="small" color="#409EFF">
                                <svg t="1713512533113" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4292" width="200" height="200"><path d="M896 583.59v221.09c0 50.13-39 90.91-86.84 90.91H214.84c-47.84 0-86.84-40.78-86.84-90.91V583.59a32 32 0 0 1 64 0v221.09c0 14.84 10.25 26.91 22.84 26.91h594.32c12.59 0 22.84-12.07 22.84-26.91V583.59a32 32 0 0 1 64 0z m-406.7 77c0.38 0.38 0.77 0.75 1.17 1.12l0.42 0.36 0.72 0.63a0.71 0.71 0 0 1 0.09 0.07l0.6 0.46 0.54 0.42 0.14 0.11 0.66 0.46 0.47 0.33 0.18 0.13 0.67 0.42 0.47 0.29 0.21 0.13c0.21 0.13 0.43 0.24 0.64 0.36l0.51 0.28 0.23 0.13 0.6 0.3 0.59 0.29 0.22 0.11 0.55 0.24 0.68 0.29 0.2 0.09 0.5 0.19 0.78 0.29 0.16 0.06 0.45 0.14 0.89 0.29h0.14l0.41 0.12 1 0.26h0.09l0.41 0.09c0.33 0.07 0.66 0.15 1 0.21h0.1l0.43 0.07 1 0.17h0.09l0.52 0.07 0.93 0.11h0.08l0.74 0.05h4.61l0.73-0.05h0.08l0.93-0.11 0.52-0.07h0.09l1-0.17 0.42-0.07h0.06l1-0.23 0.38-0.08h0.12l1-0.27 0.39-0.11h0.14l0.91-0.29 0.42-0.14 0.17-0.07 0.82-0.3 0.47-0.18 0.2-0.09 0.7-0.3 0.53-0.23 0.22-0.11 0.61-0.3 0.58-0.29 0.22-0.12 0.54-0.3 0.61-0.35 0.22-0.13 0.49-0.31 0.64-0.4 0.19-0.13 0.5-0.35c0.21-0.14 0.42-0.28 0.62-0.43l0.15-0.12 0.56-0.43 0.57-0.44a0.39 0.39 0 0 1 0.1-0.08l0.71-0.61 0.43-0.37c0.4-0.37 0.8-0.74 1.18-1.13l210.93-211a32 32 0 0 0-45.27-45.25L543.93 560.77l-0.09-400.37a32 32 0 0 0-32-32 32 32 0 0 0-32 32l0.09 400.29-156.18-156.33a32 32 0 0 0-45.28 45.23z"  p-id="4293"></path></svg>
                            </el-icon>
                            <span class="text-caption">下载文件</span>
                        </el-button>  
                    </div>
                </div>  
                <div class="border-t-sm border-b-sm mt-2 ml-2 mr-2 pt-2 pb-2 d-flex flex-row justify-space-between align-center" style="width:100%">
                    <div>
                        <el-icon size="small" color="#000000">
                            <svg t="1713513246700" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2311" width="200" height="200"><path d="M819.490858 1024c-5.119393 0-10.238787-2.559697-15.35818-5.119393L187.245779 537.657632c-5.119393-5.119393-10.238787-12.798483-10.238787-20.477573 0-7.67909 2.559697-15.35818 10.238787-20.477573L804.132678 5.240723c10.238787-7.67909 28.156663-7.67909 35.835753 5.119393 7.67909 10.238787 7.67909 28.156663-5.119393 35.835753L246.118803 517.180058l591.289932 460.745402c10.238787 7.67909 12.798483 25.596967 5.119393 35.835753C834.849038 1021.440303 827.169948 1024 819.490858 1024z" p-id="2312"></path></svg>
                        </el-icon>
                        <el-icon size="small" color="#000000" class="ml-2">
                            <svg t="1713513275169" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2458" width="200" height="200"><path d="M256 1000.369231c-3.938462 0-11.815385-3.938462-15.753846-7.876923C236.307692 984.615385 236.307692 972.8 244.184615 964.923077l492.307692-468.676923L252.061538 47.261538C244.184615 39.384615 240.246154 27.569231 248.123077 19.692308c7.876923-7.876923 19.692308-7.876923 27.569231 0l500.184615 464.738462c3.938462 3.938462 7.876923 7.876923 7.876923 15.753846 0 3.938462-3.938462 11.815385-7.876923 15.753846L271.753846 996.430769C267.815385 1000.369231 263.876923 1000.369231 256 1000.369231z" p-id="2459"></path></svg>
                        </el-icon>
                        <el-icon size="small" color="#000000" class="ml-2">
                            <svg t="1713513387645" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3559" width="200" height="200"><path d="M853.333333 768.064A426.112 426.112 0 0 1 512 938.666667C276.352 938.666667 85.333333 747.648 85.333333 512S276.352 85.333333 512 85.333333s426.666667 191.018667 426.666667 426.666667a21.333333 21.333333 0 0 1-42.666667 0c0-212.074667-171.925333-384-384-384S128 299.925333 128 512s171.925333 384 384 384a383.573333 383.573333 0 0 0 319.36-170.666667h-84.757333A21.248 21.248 0 0 1 725.333333 704c0-11.776 9.664-21.333333 21.269334-21.333333h128.128c5.866667 0 11.178667 2.346667 15.018666 6.186666l0.021334 0.106667c3.84 3.882667 6.229333 9.173333 6.229333 14.976v128.128c0 11.733333-9.472 21.269333-21.333333 21.269333-11.776 0-21.333333-9.664-21.333334-21.269333v-64z"  p-id="3560"></path></svg>
                        </el-icon>
                        <el-divider direction="vertical" />
                        <span class="text-caption">{{location}}</span>
                    </div>
                    <div class="d-flex flex-row justify-start align-center mr-4">
                        <el-dropdown @command="handleSortCommand" >
                            <el-icon size="large" class="mr-2">
                                <span v-html="sortIcon"></span>
                            </el-icon>
                            <template #dropdown>
                                <el-dropdown-menu>
                                    <el-dropdown-item command="name">
                                        <el-icon>
                                            <svg t="1713502225548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6463" width="200" height="200"><path d="M790.954667 810.666667h-173.909334l-22.613333 58.112a42.666667 42.666667 0 0 1-79.530667-30.890667l149.333334-384c14.08-36.266667 65.408-36.266667 79.530666 0l149.333334 384a42.666667 42.666667 0 0 1-79.530667 30.890667L790.954667 810.666667z m-33.194667-85.333334l-53.76-138.282666L650.24 725.333333h107.52zM170.666667 170.666667h682.666666a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 1 1 0-85.333333z m0 298.666666h298.666666a42.666667 42.666667 0 0 1 0 85.333334H170.666667a42.666667 42.666667 0 0 1 0-85.333334z m0 298.666667h256a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 0 1 0-85.333333z" fill="#222222" p-id="6464"></path></svg>
                                        </el-icon>
                                        <span class="text-caption">按名称排序</span>
                                    </el-dropdown-item >
                                    <el-dropdown-item command="time">
                                        <el-icon>
                                            <svg t="1713502681847" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4245" width="200" height="200"><path d="M120 112a8 8 0 0 0-8 8v64a8 8 0 0 0 8 8h784a8 8 0 0 0 8-8V120a8 8 0 0 0-8-8H120zM120 352a8 8 0 0 0-8 8v64a8 8 0 0 0 8 8h320a8 8 0 0 0 8-8V360a8 8 0 0 0-8-8H120zM112 600a8 8 0 0 1 8-8h192a8 8 0 0 1 8 8v64a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-64zM112 840a8 8 0 0 1 8-8h128a8 8 0 0 1 8 8v64a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-64zM636 726.308a7.996 7.996 0 0 1-4-6.928V544a8 8 0 0 1 8-8h48a8 8 0 0 1 8 8v143.048l89.44 51.64a8 8 0 0 1 2.928 10.928l-24 41.568a8 8 0 0 1-10.928 2.928L636 726.308z" fill="#091E40" fill-opacity=".9" p-id="4246"></path><path d="M968 676c0 161.268-130.732 292-292 292s-292-130.732-292-292 130.732-292 292-292 292 130.732 292 292z m-72 0c0-121.504-98.496-220-220-220s-220 98.496-220 220 98.496 220 220 220 220-98.496 220-220z" fill="#091E40" fill-opacity=".9" p-id="4247"></path></svg>
                                        </el-icon>
                                        <span class="text-caption">按创建时间排序</span>
                                    </el-dropdown-item>
                                </el-dropdown-menu>
                            </template>
                        </el-dropdown>
                        <el-dropdown @command="handleTypeCommand">
                            <el-icon size="large">
                                <span v-html="typeIcon"></span>
                            </el-icon>
                            <template #dropdown>
                                <el-dropdown-menu>
                                    <el-dropdown-item command="picture">缩略图模式</el-dropdown-item>
                                    <el-dropdown-item command="list">列表模式</el-dropdown-item>  
                                </el-dropdown-menu>
                            </template>
                        </el-dropdown>
                    </div>
                </div>
                <div>
                    <v-row no-gutters>
                        <v-col lg="2" cols="12" v-for="(item,index) in workbooks" :key="index" class="ml-4 mt-4" >
                            <v-card variant="plain" class="cursor-pointer database-card">
                                <v-card-text>
                                    <v-img src="/static/img/folder.jpg"  height="50" v-if="item.type==0">
                                    </v-img>
                                    <v-img src="/static/img/sql.jpg" height="50" v-if="item.type==1&&item.fileType==1"></v-img>
                                    <v-img src="/static/img/excel.jpg" height="50" v-if="item.type==1&&item.fileType==2"></v-img>
                                </v-card-text>
                                <v-card-actions class="d-flex flex-row justify-center align-center text-caption">
                                    {{ item.name }}
                                </v-card-actions>
                            </v-card>
                        </v-col>
                    </v-row>
                    
                </div>
            </v-window-item>
            <v-window-item value="shareData">

            </v-window-item>
        </v-window>
    </div>
</template>

<script setup lang="ts">
import {ref,onMounted} from 'vue'
import { storeToRefs } from 'pinia'
import {useDataSetStore,useLoginStore} from '@/store/index.ts'
import {insertWorkbook} from '@/api/workbook.ts'
import {ElMessage} from 'element-plus'
import moment from 'moment'
const tab = ref('workspace')
const location = ref('/我的数据集')
const sortIcon = ref('<svg t="1713502225548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6463" width="200" height="200"><path d="M790.954667 810.666667h-173.909334l-22.613333 58.112a42.666667 42.666667 0 0 1-79.530667-30.890667l149.333334-384c14.08-36.266667 65.408-36.266667 79.530666 0l149.333334 384a42.666667 42.666667 0 0 1-79.530667 30.890667L790.954667 810.666667z m-33.194667-85.333334l-53.76-138.282666L650.24 725.333333h107.52zM170.666667 170.666667h682.666666a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 1 1 0-85.333333z m0 298.666666h298.666666a42.666667 42.666667 0 0 1 0 85.333334H170.666667a42.666667 42.666667 0 0 1 0-85.333334z m0 298.666667h256a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 0 1 0-85.333333z" fill="#222222" p-id="6464"></path></svg>')
const typeIcon = ref('<svg t="1713513832857" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5573" width="200" height="200"><path d="M380.928 67.584q26.624 0 45.568 18.944t18.944 45.568l0 256q0 26.624-18.944 45.568t-45.568 18.944l-256 0q-26.624 0-45.056-18.944t-18.432-45.568l0-256q0-26.624 18.432-45.568t45.056-18.944l256 0zM380.928 580.608q26.624 0 45.568 18.432t18.944 45.056l0 256q0 26.624-18.944 45.568t-45.568 18.944l-256 0q-26.624 0-45.056-18.944t-18.432-45.568l0-256q0-26.624 18.432-45.056t45.056-18.432l256 0zM893.952 67.584q26.624 0 45.056 18.944t18.432 45.568l0 256q0 26.624-18.432 45.568t-45.056 18.944l-256 0q-26.624 0-45.568-18.944t-18.944-45.568l0-256q0-26.624 18.944-45.568t45.568-18.944l256 0zM893.952 580.608q26.624 0 45.056 18.432t18.432 45.056l0 256q0 26.624-18.432 45.568t-45.056 18.944l-256 0q-26.624 0-45.568-18.944t-18.944-45.568l0-256q0-26.624 18.944-45.056t45.568-18.432l256 0z" p-id="5574"></path></svg>')
const datasetStore = useDataSetStore()
const {workbooks} = storeToRefs(datasetStore)
const {asyncGetWorkbooks} = datasetStore
const loginStore = useLoginStore()
const {user} = storeToRefs(loginStore)
const queryPacksTablesParams = ref({
    name: ''
})
const initInsertParam = ref({
    name: '',
    creator: user.value.value.name,
    createTime: '',
    parentId: 0,
    shareAnalysis: 0,
    position: location.value,
    size: 0,
    type: 0
})
async function getWorkbooks(param:object){
    await asyncGetWorkbooks(param)
}


function handleSortCommand(command:string){
    if(command == 'name'){
        sortIcon.value = '<svg t="1713502225548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6463" width="200" height="200"><path d="M790.954667 810.666667h-173.909334l-22.613333 58.112a42.666667 42.666667 0 0 1-79.530667-30.890667l149.333334-384c14.08-36.266667 65.408-36.266667 79.530666 0l149.333334 384a42.666667 42.666667 0 0 1-79.530667 30.890667L790.954667 810.666667z m-33.194667-85.333334l-53.76-138.282666L650.24 725.333333h107.52zM170.666667 170.666667h682.666666a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 1 1 0-85.333333z m0 298.666666h298.666666a42.666667 42.666667 0 0 1 0 85.333334H170.666667a42.666667 42.666667 0 0 1 0-85.333334z m0 298.666667h256a42.666667 42.666667 0 0 1 0 85.333333H170.666667a42.666667 42.666667 0 0 1 0-85.333333z" fill="#222222" p-id="6464"></path></svg>'
    }else{
        sortIcon.value = '<svg t="1713502681847" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4245" width="200" height="200"><path d="M120 112a8 8 0 0 0-8 8v64a8 8 0 0 0 8 8h784a8 8 0 0 0 8-8V120a8 8 0 0 0-8-8H120zM120 352a8 8 0 0 0-8 8v64a8 8 0 0 0 8 8h320a8 8 0 0 0 8-8V360a8 8 0 0 0-8-8H120zM112 600a8 8 0 0 1 8-8h192a8 8 0 0 1 8 8v64a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-64zM112 840a8 8 0 0 1 8-8h128a8 8 0 0 1 8 8v64a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-64zM636 726.308a7.996 7.996 0 0 1-4-6.928V544a8 8 0 0 1 8-8h48a8 8 0 0 1 8 8v143.048l89.44 51.64a8 8 0 0 1 2.928 10.928l-24 41.568a8 8 0 0 1-10.928 2.928L636 726.308z" fill="#091E40" fill-opacity=".9" p-id="4246"></path><path d="M968 676c0 161.268-130.732 292-292 292s-292-130.732-292-292 130.732-292 292-292 292 130.732 292 292z m-72 0c0-121.504-98.496-220-220-220s-220 98.496-220 220 98.496 220 220 220 220-98.496 220-220z" fill="#091E40" fill-opacity=".9" p-id="4247"></path></svg>'
    }
}

function handleTypeCommand(command:string){
    if(command == 'picture'){
        typeIcon.value = '<svg t="1713513832857" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5573" width="200" height="200"><path d="M380.928 67.584q26.624 0 45.568 18.944t18.944 45.568l0 256q0 26.624-18.944 45.568t-45.568 18.944l-256 0q-26.624 0-45.056-18.944t-18.432-45.568l0-256q0-26.624 18.432-45.568t45.056-18.944l256 0zM380.928 580.608q26.624 0 45.568 18.432t18.944 45.056l0 256q0 26.624-18.944 45.568t-45.568 18.944l-256 0q-26.624 0-45.056-18.944t-18.432-45.568l0-256q0-26.624 18.432-45.056t45.056-18.432l256 0zM893.952 67.584q26.624 0 45.056 18.944t18.432 45.568l0 256q0 26.624-18.432 45.568t-45.056 18.944l-256 0q-26.624 0-45.568-18.944t-18.944-45.568l0-256q0-26.624 18.944-45.568t45.568-18.944l256 0zM893.952 580.608q26.624 0 45.056 18.432t18.432 45.056l0 256q0 26.624-18.432 45.568t-45.056 18.944l-256 0q-26.624 0-45.568-18.944t-18.944-45.568l0-256q0-26.624 18.944-45.056t45.568-18.432l256 0z" p-id="5574"></path></svg>'
    }else{
        typeIcon.value = '<svg t="1713513784956" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4588" width="200" height="200"><path d="M323.199 300.255v-124.892h615.538v124.893l-615.538-0.001zM77.228 667.303h122.982v122.983h-122.982v-122.983zM77.228 421.335h122.982v122.982h-122.982v-122.982zM77.228 175.364h122.982v122.982h-122.982v-122.982zM938.123 546.226h-614.924v-124.893h614.925v124.893h-0.001zM938.123 792.193h-614.924v-124.89h614.925v124.89h-0.001zM938.123 792.193z" fill="#272636" p-id="4589"></path></svg>'
    }
}

async function addWorkbook(){
    initInsertParam.value.name = '新建工作簿_' + moment(new Date()).format('YYYY-MM-DD HH:mm:ss')
    initInsertParam.value.createTime = moment(new Date()).format('YYYY-MM-DD HH:mm:ss')
    console.log(initInsertParam.value);
    
    try{
        let res = await insertWorkbook(initInsertParam.value)
        if(res.data == 1){
            await getWorkbooks({parentId:0})
        }
    }catch(err){
        ElMessage({
            type: 'error',
            message: err
        })
    }
}

onMounted(async function getWorkbooks(){
    await asyncGetWorkbooks({'parentId':0})
})
</script>